{
  "wordpress_vapt": [
    {
      "id": "author-enumeration-block",
      "key": "author-enumeration-block",
      "title": "Block Author Query Enumeration",
      "category": "Authentication",
      "severity": "medium",
      "description": "Prevents reconnaissance attacks that aim to enumerate valid usernames through archives, query parameters, REST API, and specific login errors.",
      "remediation": "Implements blocking rules in .htaccess and WordPress hooks.",
      "implementation_data": {
        "generated_schema": {
          "controls": [
            {
              "type": "toggle",
              "label": "Block Author Archives",
              "key": "block_author_archives",
              "help": "Prevents access to author archive pages (/author/N/) that reveal usernames. Requests will return 403 Forbidden.",
              "default": false
            },
            {
              "type": "toggle",
              "label": "Block Author Query Parameter",
              "key": "block_author_query",
              "help": "Blocks the ?author=N query parameter that redirects to author archives and exposes usernames.",
              "default": false
            },
            {
              "type": "toggle",
              "label": "Restrict REST API Users Endpoint",
              "key": "block_rest_users",
              "help": "Restricts access to /wp-json/wp/v2/users endpoint to prevent user enumeration via REST API.",
              "default": false
            },
            {
              "type": "toggle",
              "label": "Generic Login Error Messages",
              "key": "generic_login_errors",
              "help": "Uses generic error messages on login to prevent username enumeration through different error responses.",
              "default": false
            },
            {
              "type": "test_action",
              "label": "Verify: Author Archive Blocked",
              "key": "verify_author_archive_block",
              "test_logic": "universal_probe",
              "test_config": {
                "method": "GET",
                "url": "{{site_url}}/author/1/",
                "expected_status": 403,
                "expected_headers": {
                  "X-VAPTC-Enforced": "author-enumeration-block"
                }
              }
            },
            {
              "type": "test_action",
              "label": "Verify: Author Query Blocked",
              "key": "verify_author_query_block",
              "test_logic": "universal_probe",
              "test_config": {
                "method": "GET",
                "url": "{{site_url}}/?author=1",
                "expected_status": 403,
                "expected_headers": {
                  "X-VAPTC-Enforced": "author-enumeration-block"
                }
              }
            },
            {
              "type": "test_action",
              "label": "Verify: REST API Users Restricted",
              "key": "verify_rest_users_block",
              "test_logic": "universal_probe",
              "test_config": {
                "method": "GET",
                "url": "{{site_url}}/wp-json/wp/v2/users",
                "expected_status": 401,
                "expected_headers": {
                  "X-VAPTC-Enforced": "author-enumeration-block"
                }
              }
            },
            {
              "type": "textarea",
              "key": "operational_notes",
              "label": "Operational Notes",
              "rows": 5,
              "read_only": true,
              "default_value": "This feature provides comprehensive protection against WordPress user enumeration attacks through multiple vectors:\n\n1. **Author Archives**: Blocks /author/N/ URLs using .htaccess rules\n2. **Author Query**: Blocks ?author=N parameter using .htaccess rules\n3. **REST API**: Restricts /wp-json/wp/v2/users endpoint using WordPress hooks\n4. **Login Errors**: Implements generic error messages using WordPress hooks.\n\n**Requirements**: Apache server with mod_rewrite enabled for .htaccess rules. REST API and login protections work on all server types.\n\n**Testing**: After enabling, verify that /author/1/ returns 403, ?author=1 is blocked, and REST API users endpoint requires authentication."
            }
          ],
          "enforcement": {
            "driver": "htaccess",
            "target": "root",
            "mappings": {
              "block_author_archives": "# Block Author Archive URLs\nRewriteEngine On\nRewriteCond %{REQUEST_URI} ^/author/ [NC]\nRewriteRule .* {{site_url}} [R=403,L]\nHeader always set X-VAPTC-Enforced \"author-enumeration-block\"\nHeader always set X-VAPTC-Site \"{{domain}}\"",
              "block_author_query": "# Block Author Query Parameter\nRewriteEngine On\nRewriteCond %{QUERY_STRING} (^|&)author= [NC]\nRewriteRule .* {{site_url}} [R=403,L]\nHeader always set X-VAPTC-Enforced \"author-enumeration-block\"\nHeader always set X-VAPTC-Site \"{{domain}}\"",
              "block_rest_users": "hook:restrict_rest_users_endpoint",
              "generic_login_errors": "hook:use_generic_login_errors"
            },
            "hook_methods": {
              "restrict_rest_users_endpoint": {
                "description": "Restricts REST API users endpoint to authenticated users only",
                "hook": "rest_endpoints",
                "priority": 10,
                "implementation": "Remove or restrict the /wp/v2/users endpoint to require authentication"
              },
              "use_generic_login_errors": {
                "description": "Replaces specific login error messages with generic ones",
                "hook": "login_errors",
                "priority": 10,
                "implementation": "Return generic error message regardless of whether username exists"
              }
            }
          }
        }
      },
      "driver": "htaccess",
      "status": "Release"
    }
  ]
}