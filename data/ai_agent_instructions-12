{
  "ai_agent_instructions": {
    "ui_builder_context": {
      "feature_profile": {
        "risk_category": "{category}",
        "severity_level": "{severity.level}",
        "cvss_score": "{severity.cvss_score}",
        "implementation_complexity": "{protection.remediation_effort}",
        "estimated_duration": "{protection.estimated_time}",
        "priority_rank": "{protection.priority}"
      },
      
      "conditional_ui_logic": {
        "show_when": {
          "severity_is_high": "{severity.level} === 'high'",
          "severity_is_medium": "{severity.level} === 'medium'",
          "severity_is_low": "{severity.level} === 'low'",
          "has_dropdown_options": "{ui_configuration.components[?type=='dropdown'].length} > 0",
          "is_authentication_risk": "{category} === 'Authentication'",
          "is_configuration_risk": "{category} === 'Configuration'",
          "is_information_disclosure": "{category} === 'Information Disclosure'",
          "is_api_security": "{category} === 'API Security'",
          "requires_confirmation": "{ui_configuration.actions[0].confirmation_required} === true",
          "has_dependencies": "{ui_configuration.components[?dependencies.length > 0].length} > 0"
        },
        
        "dynamic_fields": {
          "severity_high_only": {
            "condition": "{severity.level} === 'high'",
            "add_fields": [
              {
                "type": "alert",
                "component_id": "ALERT-{risk_id}-HIGH",
                "severity": "critical",
                "message": "⚠️ High Severity Risk: Immediate attention recommended",
                "dismissible": false,
                "style": "banner"
              },
              {
                "type": "checkbox",
                "component_id": "CHECK-{risk_id}-BACKUP",
                "label": "I have created a backup before enabling this protection",
                "required": true,
                "validation_message": "Backup confirmation required for high-severity protections"
              }
            ]
          },
          
          "severity_medium_only": {
            "condition": "{severity.level} === 'medium'",
            "add_fields": [
              {
                "type": "info",
                "component_id": "INFO-{risk_id}-MED",
                "message": "ℹ️ Medium Severity: Review impact on your specific use case",
                "style": "callout"
              }
            ]
          },
          
          "authentication_category": {
            "condition": "{category} === 'Authentication'",
            "add_fields": [
              {
                "type": "select",
                "component_id": "SELECT-{risk_id}-AUTH-METHOD",
                "label": "Authentication Protection Method",
                "options": [
                  {"value": "standard", "label": "Standard Protection"},
                  {"value": "enhanced", "label": "Enhanced with Logging"},
                  {"value": "strict", "label": "Strict Mode (May block legitimate users)"}
                ],
                "default": "standard",
                "help_text": "Choose how aggressively to protect authentication endpoints"
              }
            ],
            "modify_existing": {
              "component_id": "UI-{title_slug}-001",
              "override_label": "Enable Authentication Protection",
              "override_description": "Protects login and authentication endpoints from attacks"
            }
          },
          
          "has_protection_level_dropdown": {
            "condition": "{ui_configuration.components[?type=='dropdown'].length} > 0",
            "add_fields": [
              {
                "type": "accordion",
                "component_id": "ACCORDION-{risk_id}-LEVELS",
                "title": "Protection Level Details",
                "content": {
                  "permissive": "Allows normal usage with minimal restrictions. Best for development.",
                  "moderate": "Balanced security with occasional validation. Recommended for most sites.",
                  "strict": "Maximum security, may require additional configuration. For high-security sites."
                }
              }
            ]
          },
          
          "requires_plugin": {
            "condition": "{protection.automated_protection.method} === 'plugin-configuration'",
            "add_fields": [
              {
                "type": "plugin_notice",
                "component_id": "PLUGIN-{risk_id}-NOTICE",
                "message": "This protection requires plugin configuration. No coding needed.",
                "icon": "puzzle-piece",
                "style": "info"
              }
            ]
          },
          
          "manual_steps_exist": {
            "condition": "{protection.manual_steps.length} > 0",
            "add_fields": [
              {
                "type": "expandable_section",
                "component_id": "MANUAL-{risk_id}-STEPS",
                "title": "Manual Verification Steps",
                "content_source": "{protection.manual_steps}",
                "collapsed_by_default": true
              }
            ]
          }
        },
        
        "skip_when": {
          "no_dropdown_options": {
            "condition": "{ui_configuration.components[?type=='dropdown'].options.length} === 0",
            "skip_fields": ["protection_level_accordion", "level_selector"]
          },
          "simple_toggle_only": {
            "condition": "{ui_configuration.components.length} === 1 && {ui_configuration.components[0].type} === 'toggle'",
            "skip_fields": ["advanced_configuration_panel", "dependency_visualization"]
          },
          "low_priority": {
            "condition": "{protection.priority} <= 4",
            "skip_fields": ["priority_banner", "urgency_indicator"]
          }
        }
      },
      
      "component_enhancements": {
        "toggle_component": {
          "add_badge_when": {
            "condition": "{severity.level} === 'high'",
            "badge": {
              "text": "HIGH PRIORITY",
              "color": "red",
              "position": "right"
            }
          },
          "add_tooltip": {
            "content": "{description.summary}",
            "position": "top",
            "delay": 500
          },
          "icon_mapping": {
            "Authentication": "lock",
            "Configuration": "settings",
            "Information Disclosure": "eye-off",
            "API Security": "api"
          }
        },
        
        "dropdown_component": {
          "add_description_per_option": {
            "source": "conditional_ui_logic.dynamic_fields.has_protection_level_dropdown.add_fields[0].content",
            "display_mode": "inline_help"
          }
        }
      },
      
      "layout_intelligence": {
        "section_assignment": {
          "high_severity_advanced": "{severity.level} === 'high' && {protection.remediation_effort} !== 'low'",
          "medium_severity_general": "{severity.level} === 'medium'",
          "low_severity_collapsed": "{severity.level} === 'low'"
        },
        
        "ordering_hints": {
          "primary_sort": "{protection.priority}",
          "secondary_sort": "{severity.cvss_score}",
          "tertiary_sort": "{metadata.created_at}"
        }
      },
      
      "action_customization": {
        "enable_button": {
          "label_override": {
            "high_severity": "Enable Critical Protection",
            "medium_severity": "Enable Protection",
            "default": "Enable"
          },
          "color_override": {
            "high_severity": "danger",
            "default": "primary"
          },
          "icon": {
            "high_severity": "shield-alert",
            "authentication": "lock",
            "default": "shield"
          }
        },
        
        "confirmation_dialog": {
          "enhance_when": "{severity.level} === 'high' || {protection.automated_protection.method} === 'server-configuration'",
          "add_details": [
            "{description.summary}",
            "{protection.estimated_time} implementation time",
            "{protection.manual_steps[0].verification}"
          ]
        }
      }
    },
    
    "context_aware_help": {
      "feature_summary_card": {
        "title": "{title}",
        "risk_id": "{risk_id}",
        "category_badge": "{category}",
        "severity_indicator": {
          "level": "{severity.level}",
          "cvss": "{severity.cvss_score}",
          "color_coding": {
            "high": "#dc2626",
            "medium": "#ea580c", 
            "low": "#16a34a"
          }
        },
        "quick_actions": [
          {
            "label": "View Attack Scenario",
            "content": "{description.attack_scenario}",
            "modal": true
          },
          {
            "label": "Testing Steps",
            "content": "{testing.verification_steps}",
            "expandable": true
          }
        ]
      },
      
      "inline_documentation": {
        "owasp_mapping": {
          "show_badge": true,
          "link_to": "https://owasp.org/Top10/{owasp_mapping.owasp_top_10_2021}/"
        },
        "cwe_references": {
          "show_tags": true,
          "linkable": true
        }
      }
    },
    
    "dynamic_validation_rules": {
      "cross_field_validation": {
        "backup_before_high_severity": {
          "trigger": "{severity.level} === 'high'",
          "rule": "user_must_confirm_backup",
          "error_message": "High severity protections require backup confirmation"
        }
      },
      
      "dependency_chain": {
        "auto_enable_dependencies": "{ui_configuration.components[?dependencies.length > 0].dependencies}",
        "visualize_dependency_tree": true
      }
    }
  }
}
