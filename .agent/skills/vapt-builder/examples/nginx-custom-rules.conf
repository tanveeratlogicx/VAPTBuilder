# VAPT Builder - Nginx Rules Example
# Copy these into your server block or valid location context.

# 1. Security Headers
add_header X-Content-Type-Options "nosniff" always;
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
add_header X-VAPTC-Enforced "security-headers" always;

# 2. Block Sensitive Files
location ~* \.(log|ini|git|env|sh|sql)$ {
    deny all;
    return 403;
}

# 3. Block XML-RPC
location = /xmlrpc.php {
    deny all;
    return 403;
}

# 4. Disable Directory Listing
autoindex off;

# 5. Block User Enumeration (REST API)
location ~ ^/wp-json/wp/v2/users {
    deny all;
    return 403;
}

# 6. Block PHP Execution in Uploads
location ~* ^/wp-content/uploads/.*\.php$ {
    deny all;
    return 403;
}
