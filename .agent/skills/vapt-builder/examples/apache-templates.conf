# Apache .htaccess Security Template for VAPTBuilder

# ----------------------------------------------------------------------
# | Security Headers                                                   |
# ----------------------------------------------------------------------
<IfModule mod_headers.c>
    # Prevent clickjacking
    Header set X-Frame-Options "SAMEORIGIN"
    # Prevent sniffing
    Header set X-Content-Type-Options "nosniff"
    # XSS Protection
    Header set X-XSS-Protection "1; mode=block"
    # Strict Transport Security (HSTS)
    Header set Strict-Transport-Security "max-age=31536000; includeSubDomains" env=HTTPS
    # Referrer Policy
    Header set Referrer-Policy "no-referrer-when-downgrade"
    # Evidence Header (VAPT Specific)
    Header set X-VAPTC-Enforced "security-headers"
</IfModule>

# ----------------------------------------------------------------------
# | Block Sensitive Files                                              |
# ----------------------------------------------------------------------
<FilesMatch "^(wp-config\.php|readme\.html|license\.txt|debug\.log|error\.log)">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# ----------------------------------------------------------------------
# | Block XML-RPC                                                      |
# ----------------------------------------------------------------------
<Files "xmlrpc.php">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</Files>

# ----------------------------------------------------------------------
# | Block Directory Browsing                                           |
# ----------------------------------------------------------------------
<IfModule mod_autoindex.c>
    Options -Indexes
</IfModule>

# ----------------------------------------------------------------------
# | Block PHP Execution in Uploads                                     |
# ----------------------------------------------------------------------
# Note: This usually goes in /wp-content/uploads/.htaccess
<FilesMatch "\.(php|php\.)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>
